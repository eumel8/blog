---
layout: post
tag: general
title: Wallabag
subtitle: Bookmark Dienst im Eigenbau
date: 2025-05-24
author: eumel8
---

# Intro

Diigo ist tot, Pocket ist tot ... bald gibt's keine vernünftigen Bookmark Dienste mehr. Als im Addon-Store von Firefox gibt es noch genug, aber wenige genügen diesen Anforderungen:

* Firefox-Plugin mit rechtem Mausklick oder sonstigem einfachen Speichern der aktuellen Webseite
* Zentrale Datenhaltung, damit man von verschiedenen Rechnern drauf zugreifen kann
* Import/Export in gängige Formate
* Kostenlos (nein, ich will nicht 20 Dollar dafür zahlen pro Monat)
* Aktuell gepflegt

Okay, der letzte Punkt kostet Zeit und Geld und damit geht der vorletzte Punkt flöten. ChatGPT empfohl dann: Wallabag. Häh? Nie gehört!

# Wallabag

[Wallabag](https://wallabag.org/) ist ein Bookmark Dienst, der zumindest seinen Quellcode offen bei [Github](https://github.com/wallabag/wallabag) beherbergt. Dort ist dann auch zu sehen, dass das Projekt sehr aktiv ist und sehr viele Maintainer unterwegs sind. Das ist ein sehr gutes Zeichen. Auf der Herstellerwebseite selber gibt es auch ein Hostingangebot für 11 Dollar im Jahr. Das würde noch gehen, aber wir wollen es selber bauen und betreiben. Los geht's!

# Container

Technisch ist Wallabag eine PHP-Anwendung. Die Daten werden standardmässig in einer SQLLite Datenbank vorgehalten. Geradezu perfekt, wennauch PHP gerade bei mir auf dem absteigenden Ast unterwegs ist. Hab jetzt schon mehrere Major-Updates hinter mir und wenn man mehrere Anwendungen auf derselben Plattform mit demselben PHP betreibt, diese dann aktualisiert, um dann festzustellen, dass die Hälfte danach nicht mehr geht, ist das schon sehr lästig. 
Um so perfekter ist es, dass die [Wallabag Community](https://github.com/wallabag/docker) auch ein Docker Image bereithält.
Kleiner Wehrmutstropfen: Es läuft nicht unpriveligiert, aber immerhin gibt es eins.
Mit 

```
$ docker run -p 80:80 -e "SYMFONY__ENV__DOMAIN_NAME=http://localhost" wallabag/wallabag
```

kann es auch schon losgehen, wenn man SQLLite verwendet, ansonsten kann man auch eine MySQL dranfummeln.

# Kubernetes

Wenn man Docker hat, hat man fast schon Kubernetes. Man kann Wallabag also im Kubernetes Cluster betreiben. Alles was man brauch, ist ein Helm-Chart, um Wallabag komfortabel zu deployen. Auch hier gab es schon einen [netten Menschen](https://github.com/roadhouse/helm-wallabag), der da schon mal was gebastelt hat. Ein erster Wurf für ein Helm-Chart, aber immerhin gibt es eins.

# Deployment

Das Helm-Chart hab ich etwas [gepimpt](https://github.com/eumel8/helm-wallabag/tree/feat/enhance-helm-chart-1), damit man auch einen Ingres konfigurieren kann und Storage konfigurieren für die SQLLite.

Auch das Wallabag-Image hat einen kleinen Fehler bzw. fehlt ein Konfigurations-Parameter, wenn man sehr viele Books gleichzeitig importieren muss. Ein Bugfix [hier](https://github.com/eumel8/wallabag-docker/tree/fix/proxy-timeout-1)


In einem  Kubernetes-Cluster mit CSI und Ingress-Controller kann ich das mit meinem Values deployen:

```yaml
image:
  repository: ghcr.io/eumel8/wallabag/wallabag
  tag: proxy-timeout-2
  pullPolicy: Always

issuer:
  enabled: true
  emailAddress: eumel@arcor.de

ingress:
  domainName: wallabag1.eumel.de
  proxyConnectTimeout: 3600s
  proxyReadTimeout: 3600s
  enabled: true

persistence:
  enabled: true
  hostPath: "/data"

env:
  SYMFONY__ENV__DOMAIN_NAME: "https://wallabag1.eumel.de:443"
  PHP_MEMORY_LIMIT: 2048M
  FASTCGI_READ_TIMEOUT: 3600s

# minimal permissions for container
podSecurityContext: {}
securityContext: {}
```

helm -n wallabag upgrade -i wallabag -f my-values.yaml . --create-namespace
